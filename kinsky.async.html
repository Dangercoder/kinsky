<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>kinsky.async documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Kinsky</span> <span class="project-version">0.1.3</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>kinsky</span></div></div></li><li class="depth-2 branch current"><a href="kinsky.async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async</span></div></a></li><li class="depth-2"><a href="kinsky.client.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="kinsky.async.html#var-channel-listener"><div class="inner"><span>channel-listener</span></div></a></li><li class="depth-1"><a href="kinsky.async.html#var-consume.21"><div class="inner"><span>consume!</span></div></a></li><li class="depth-1"><a href="kinsky.async.html#var-exception.3F"><div class="inner"><span>exception?</span></div></a></li><li class="depth-1"><a href="kinsky.async.html#var-make-consumer"><div class="inner"><span>make-consumer</span></div></a></li><li class="depth-1"><a href="kinsky.async.html#var-make-producer"><div class="inner"><span>make-producer</span></div></a></li><li class="depth-1"><a href="kinsky.async.html#var-next-poller"><div class="inner"><span>next-poller</span></div></a></li><li class="depth-1"><a href="kinsky.async.html#var-producer"><div class="inner"><span>producer</span></div></a></li><li class="depth-1"><a href="kinsky.async.html#var-record-xform"><div class="inner"><span>record-xform</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">kinsky.async</h1><div class="doc"><div class="markdown"><p>Clojure core.async support in kinsky. See <a href="https://github.com/pyr/kinsky">https://github.com/pyr/kinsky</a> for example usage.</p></div></div><div class="public anchor" id="var-channel-listener"><h3>channel-listener</h3><div class="usage"><code>(channel-listener ch)</code></div><div class="doc"><div class="markdown"><p>A rebalance-listener compatible call back which produces all events onto a channel.</p></div></div><div class="src-link"><a href="https://github.com/pyr/kinsky/blob/0.1.3/src/kinsky/async.clj#L50">view source</a></div></div><div class="public anchor" id="var-consume.21"><h3>consume!</h3><div class="usage"><code>(consume! config topics)</code><code>(consume! config kd vd topics)</code></div><div class="doc"><div class="markdown"><p>Build a consumer for a topic or list of topics which will produce records onto a channel.</p>
<p>Arguments config, kd and vd work as for kinsky.client/consumer Argument topics is as for kinsky.client/subscribe</p>
<p>Yields a vector of three values: [consumer records ctl]</p>
<ul>
  <li>consumer is a consumer driver, see  <a href="kinsky.client.html#var-consumer">kinsky.client/consumer</a></li>
  <li>records is a channel of records, see  <a href="#var-record-xform">kinsky.client/record-xform</a>  for content description</li>
  <li>ctl is a channel of control messages, as given by the rebalance  listener or exception if they were produced by the transducer.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/pyr/kinsky/blob/0.1.3/src/kinsky/async.clj#L81">view source</a></div></div><div class="public anchor" id="var-exception.3F"><h3>exception?</h3><div class="usage"><code>(exception? e)</code></div><div class="doc"><div class="markdown"><p>Test if a value is a subclass of Exception</p></div></div><div class="src-link"><a href="https://github.com/pyr/kinsky/blob/0.1.3/src/kinsky/async.clj#L67">view source</a></div></div><div class="public anchor" id="var-make-consumer"><h3>make-consumer</h3><div class="usage"><code>(make-consumer config stop kd vd)</code></div><div class="doc"><div class="markdown"><p>Build a consumer, with or without deserializers</p></div></div><div class="src-link"><a href="https://github.com/pyr/kinsky/blob/0.1.3/src/kinsky/async.clj#L72">view source</a></div></div><div class="public anchor" id="var-make-producer"><h3>make-producer</h3><div class="usage"><code>(make-producer config ks vs)</code></div><div class="doc"><div class="markdown"><p>Build a producer, with or without serializers</p></div></div><div class="src-link"><a href="https://github.com/pyr/kinsky/blob/0.1.3/src/kinsky/async.clj#L121">view source</a></div></div><div class="public anchor" id="var-next-poller"><h3>next-poller</h3><div class="usage"><code>(next-poller consumer timeout)</code></div><div class="doc"><div class="markdown"><p>Poll for next messages, catching exceptions and yielding them.</p></div></div><div class="src-link"><a href="https://github.com/pyr/kinsky/blob/0.1.3/src/kinsky/async.clj#L57">view source</a></div></div><div class="public anchor" id="var-producer"><h3>producer</h3><div class="usage"><code>(producer config)</code><code>(producer config ks)</code><code>(producer config ks vs)</code></div><div class="doc"><div class="markdown"><p>Build a producer, reading records to send from a channel.</p>
<p>Arguments config ks and vs work as for kinsky.client/producer.</p>
<p>Yields a vector of three values: [producer records ctl]</p>
<ul>
  <li>producer is a producer driver, see:  <a href="kinsky.client.html#var-producer">kinsky.client/producer</a></li>
  <li>records expects records to produce, see:  <a href="kinsky.client.html#var-send.21">kinsky.client/send!</a></li>
  <li>ctl is a channel which will receive any exception received  during production.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/pyr/kinsky/blob/0.1.3/src/kinsky/async.clj#L128">view source</a></div></div><div class="public anchor" id="var-record-xform"><h3>record-xform</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>A transducer to explode grouped records into individual entities.</p>
<p>When sucessful, the output of kinsky.client/poll! takes the form:</p>
<pre><code>{:partitions   [[&quot;t&quot; 0] [&quot;t&quot; 1]]
 :topics       #{&quot;t&quot;}
 :count        2
 :by-partition {[&quot;t&quot; 0] [{:key       &quot;k0&quot;
                            :offset    1
                            :partition 0
                            :topic     &quot;t&quot;
                            :value     &quot;v0&quot;}]
                [&quot;t&quot; 1] [{:key       &quot;k1&quot;
                            :offset    1
                            :partition 1
                            :topic     &quot;t&quot;
                            :value     &quot;v1&quot;}]}
 :by-topic      {&quot;t&quot; [{:key       &quot;k0&quot;
                         :offset    1
                         :partition 0
                         :topic     &quot;t&quot;
                         :value     &quot;v0&quot;}
                        {:key       &quot;k1&quot;
                         :offset    1
                         :partition 1
                         :topic     &quot;t&quot;
                         :value     &quot;v1&quot;}]}}
</code></pre>
<p>To make working with the output channel easier, this transducer morphs these messages into a list of distinct records:</p>
<pre><code>({:key &quot;k0&quot; :offset 1 :partition 0 :topic &quot;t&quot; :value &quot;v0&quot;}
 {:key &quot;k1&quot; :offset 1 :partition 1 :topic &quot;t&quot; :value &quot;v1&quot;}
 ...)
</code></pre></div></div><div class="src-link"><a href="https://github.com/pyr/kinsky/blob/0.1.3/src/kinsky/async.clj#L7">view source</a></div></div></div></body></html>